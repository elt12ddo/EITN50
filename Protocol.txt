Handshake:

Client: Hello + prime g

Server: Hello + prime p

Client: initDH + initialDHmessageClient

Server: initDH + initialDHmessageServer

Client: IV + iv

Server: IV + iv2

Client: enc(all recieved messages from server + nonce)

Server: enc(all recieved messages from client + nonce)

*******************
Handshake done
*******************

Data exchange:

...